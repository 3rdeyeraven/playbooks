{
    "blockly": false,
    "blockly_xml": "<xml></xml>",
    "category": "Use Cases",
    "misc": { "apps_list": ["Passivetotal", "WHOIS", "MaxMind", "Censys", "DNS", "Malware Domain List"] },
    "coa": {
        "data": {
            "clean": true,
            "code_block": "def extract_domain_from_url(url):\n    try:\n        domain = url.split('://', 1)[1].split('/', 1)[0]\n    except:\n        return None\n    return domain",
            "description": "This Playbook is part of the Splunk Analytic Story called DNS hijack. It is made to be run when the Detection Search within that story called \"DNS record changed\" is used to identify DNS record changes for cloud and corporate domains. The detection search is dependent on a support searched called \"Discover DNS records\" which finds the common DNS responses for the last 30 days of monitored corporate domains and cloud providers (located in lookups: cim_corporate_email_domains.csv, cim_corporate_web_domains.csv, and cloud_domains.csv from Splunk CIM App). Stores these responses under lookup discovered_dns_records.csv. The playbook takes in the DNS record changed and uses geoip, whois, censys and passive total to detect if DNS issuers changed.",
            "joint": {
                "cells": [
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "13045ed8-ec8f-48d7-8e41-431388b360b2",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "fb656ce5-6bb6-4598-89ec-3a1fa425da4a",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "579d254e-f7e0-4713-9ff1-ffe6e95159e3",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "vertices": [
                            {
                                "x": 180,
                                "y": 300
                            }
                        ],
                        "z": 56
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "505d65fd-0265-48f3-bc4c-d5572b45d84e",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "7611cb89-72b4-48c2-b47f-3c36f3782911",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "5c4cb229-8f0b-4ac2-a106-82f25a0872c6",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 164
                    },
                    {
                        "0": "E",
                        "1": "N",
                        "2": "D",
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".title": {
                                "text": "END"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_end.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def on_finish(container, summary):\n    phantom.debug('on_finish() called')\n    # This function is called after all actions are completed.\n    # summary of all the action and/or all detals of actions \n    # can be collected here.\n\n    # summary_json = phantom.get_summary()\n    # if 'result' in summary_json:\n        # for action_result in summary_json['result']:\n            # if 'action_run_id' in action_result:\n                # action_results = phantom.get_action_results(action_run_id=action_result['action_run_id'], result_data=False, flatten=False)\n                # phantom.debug(action_results)\n\n    return",
                        "callback_code": "# read-only block view not available",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "acdb33d7-aad8-43a9-8707-39ca2e2d063d",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "# read-only block view not available",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 340,
                        "line_start": 327,
                        "name": "",
                        "notes": "",
                        "number": 0,
                        "outPorts": [],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1800,
                            "y": 840
                        },
                        "previous_function": "",
                        "previous_name": "",
                        "show_number": true,
                        "size": {
                            "height": 54,
                            "width": 80
                        },
                        "status": "",
                        "title": "END",
                        "type": "coa.StartEnd",
                        "warn": false,
                        "z": 492
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "1a82074c-ef63-431a-8534-9e4c106a3ed5",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "579d254e-f7e0-4713-9ff1-ffe6e95159e3",
                            "port": "out-1",
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "7611cb89-72b4-48c2-b47f-3c36f3782911",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 503
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "885e7c18-104d-44bb-a0eb-046ccd1c0bdc",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "9be467a5-9d8f-4894-ac82-34aa649b8795",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "da2f10c6-2cd8-427a-8d17-06c8f9496d2b",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 545
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "aaf911f6-74e6-43e9-a87b-85a7b1de28d5",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "5c4cb229-8f0b-4ac2-a106-82f25a0872c6",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "3640d401-19b9-4d63-b389-f76477198916",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 558
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "f2d2e941-6220-42b5-af97-c50710e37629",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "a133dd12-e4c4-4daf-8cf2-072f80ba7724",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "9be467a5-9d8f-4894-ac82-34aa649b8795",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 569
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "b7c13a77-1093-4cd3-919d-dd0dc0a1d6bc",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "fb656ce5-6bb6-4598-89ec-3a1fa425da4a",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "ad04a24d-9496-4fb8-810c-f388679c2590",
                            "port": "in",
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 578
                    },
                    {
                        "0": "S",
                        "1": "T",
                        "2": "A",
                        "3": "R",
                        "4": "T",
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "ref-x": 33,
                                "text": "START"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.icon image": {
                                "ref-x": 13,
                                "xlink:href": "/inc/coa/img/block_icon_start.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def on_start(container):\n    phantom.debug('on_start() called')\n    \n    # call 'filter_1' block\n    filter_1(container=container)\n\n    # call 'filter_2' block\n    filter_2(container=container)\n\n    return",
                        "callback_code": "# read-only block view not available",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "fb656ce5-6bb6-4598-89ec-3a1fa425da4a",
                        "inPorts": [],
                        "join_code": "# read-only block view not available",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 33,
                        "line_start": 22,
                        "name": "",
                        "notes": "",
                        "number": 0,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 80,
                            "y": 280
                        },
                        "previous_function": "",
                        "previous_name": "",
                        "show_number": true,
                        "size": {
                            "height": 54,
                            "width": 80
                        },
                        "status": "",
                        "title": "START",
                        "type": "coa.StartEnd",
                        "warn": false,
                        "z": 582
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "transform": "rotate(45 30 70)"
                            },
                            ".border": {
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 2
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block",
                                "opacity": 1
                            },
                            "g.notes image": {
                                "xlink:href": "/inc/coa/img/block_icon_note_on.svg"
                            }
                        },
                        "block_code": "def filter_2(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('filter_2() called')\n\n    # collect filtered artifact ids for 'if' condition 1\n    matched_artifacts_1, matched_results_1 = phantom.condition(\n        container=container,\n        conditions=[\n            [\"artifact:*.cef.query\", \"!=\", \"\"],\n        ],\n        name=\"filter_2:condition_1\")\n\n    # call connected blocks if filtered artifacts or results\n    if matched_artifacts_1 or matched_results_1:\n        Malware_Domain_Lookup(action=action, success=success, container=container, results=results, handle=handle, filtered_artifacts=matched_artifacts_1, filtered_results=matched_results_1)\n        Passive_Total_Domain_Reputation(action=action, success=success, container=container, results=results, handle=handle, filtered_artifacts=matched_artifacts_1, filtered_results=matched_results_1)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "Condition 1:  Investigate artifacts where destinationDnsDomain is not empty\nCondition 2: Investigate artifacts where requestURL is not empty\nCondition 3: Investigate artifacts where sourceDnsDomain is not empty",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "ad04a24d-9496-4fb8-810c-f388679c2590",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 79,
                        "line_start": 61,
                        "name": "filter",
                        "notes": "Filter the fields that commonly contain domain names or URL's to feed those artifacts into investigation actions",
                        "number": 2,
                        "outPorts": [
                            "out-1"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": "!=",
                                        "data_type": "",
                                        "param": "artifact:*.cef.query",
                                        "value": ""
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 220,
                            "y": 420
                        },
                        "previous_function": "",
                        "previous_name": "filter_2",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "filter",
                        "status": "",
                        "type": "coa.Filter",
                        "warn": false,
                        "z": 583
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "6482f66e-35c6-4b46-9f4f-ed9a00361cd9",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "5c4cb229-8f0b-4ac2-a106-82f25a0872c6",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "672d282b-7a34-40da-aab8-d72b9e14fa29",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 590
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "36cf039b-8ae6-43f5-b592-1ce03145fafa",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "672d282b-7a34-40da-aab8-d72b9e14fa29",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "9be467a5-9d8f-4894-ac82-34aa649b8795",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 594
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "a3298b8e-5ee8-4910-a42f-914b10889b0c",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "97a62ca0-1914-4ef2-b779-56cb692b559a",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "9be467a5-9d8f-4894-ac82-34aa649b8795",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "vertices": [
                            {
                                "x": 800,
                                "y": 520
                            }
                        ],
                        "z": 606
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "61ed2269-017b-4ead-a4ec-efb5b7ce8cc9",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "79f28b84-d3b0-4322-9da2-848949d8048f",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "9be467a5-9d8f-4894-ac82-34aa649b8795",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "vertices": [
                            {
                                "x": 920,
                                "y": 600
                            },
                            {
                                "x": 1040,
                                "y": 620
                            }
                        ],
                        "z": 636
                    },
                    {
                        "action": "whois ip",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "ip": "geolocate_ip_dst:action_result.parameter.ip"
                        },
                        "angle": 0,
                        "app": "",
                        "approver": "",
                        "assets": [
                            {
                                "action": "whois ip",
                                "active": true,
                                "app_name": "WHOIS",
                                "app_version": "1.2.31",
                                "asset_name": "whois",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "ip": "Geolocate_IP:action_result.parameter.ip"
                                },
                                "has_app": true,
                                "id": 41,
                                "loaded": false,
                                "missing": false,
                                "name": "whois",
                                "output": [
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.parameter.ip",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Asn",
                                        "column_order": 2,
                                        "data_path": "action_result.data.*.asn",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Asn Cidr",
                                        "column_order": 3,
                                        "data_path": "action_result.data.*.asn_cidr",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Asn Country Code",
                                        "column_order": 4,
                                        "data_path": "action_result.data.*.asn_country_code",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Asn Date",
                                        "column_order": 5,
                                        "data_path": "action_result.data.*.asn_date",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Asn Registry",
                                        "column_order": 6,
                                        "data_path": "action_result.data.*.asn_registry",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Abuse Emails",
                                        "column_order": 7,
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.data.*.nets.*.abuse_emails",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Address",
                                        "column_order": 8,
                                        "data_path": "action_result.data.*.nets.*.address",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Cidr",
                                        "column_order": 9,
                                        "data_path": "action_result.data.*.nets.*.cidr",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "City",
                                        "column_order": 10,
                                        "data_path": "action_result.data.*.nets.*.city",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Country",
                                        "column_order": 11,
                                        "data_path": "action_result.data.*.nets.*.country",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Created",
                                        "column_order": 12,
                                        "data_path": "action_result.data.*.nets.*.created",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Description",
                                        "column_order": 13,
                                        "data_path": "action_result.data.*.nets.*.description",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_order": 7,
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.data.*.nets.*.emails",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.nets.*.handle",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Name",
                                        "column_order": 14,
                                        "data_path": "action_result.data.*.nets.*.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Postal Code",
                                        "column_order": 15,
                                        "data_path": "action_result.data.*.nets.*.postal_code",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Range",
                                        "column_order": 16,
                                        "data_path": "action_result.data.*.nets.*.range",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "State",
                                        "column_order": 17,
                                        "data_path": "action_result.data.*.nets.*.state",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Tech Emails",
                                        "column_order": 18,
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.data.*.nets.*.tech_emails",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Updated",
                                        "column_order": 19,
                                        "data_path": "action_result.data.*.nets.*.updated",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.query",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "IP",
                                        "column_order": 0,
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.parameter.ip",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Misc Emails",
                                        "column_order": 20,
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.data.*.nets.*.misc_emails",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary.asn",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary.country_code",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary.nets.*.address",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary.nets.*.range",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary.registry",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "ip": {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "IP to query",
                                        "key": "ip",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    }
                                },
                                "product_name": "Whois",
                                "product_vendor": "Generic",
                                "targets": "3",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "WHOIS Lookup"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "xlink:href": "/inc/coa/img/block_icon_note_on.svg"
                            }
                        },
                        "block_code": "def WHOIS_Lookup(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('WHOIS_Lookup() called')\n    \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'WHOIS_Lookup' call\n    results_data_1 = phantom.collect2(container=container, datapath=['Geolocate_IP:action_result.parameter.ip', 'Geolocate_IP:action_result.parameter.context.artifact_id'], action_results=results)\n\n    parameters = []\n    \n    # build parameters list for 'WHOIS_Lookup' call\n    for results_item_1 in results_data_1:\n        if results_item_1[0]:\n            parameters.append({\n                'ip': results_item_1[0],\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': results_item_1[1]},\n            })\n\n    phantom.act(\"whois ip\", parameters=parameters, assets=['whois'], callback=WHOIS_Lookup_callback, name=\"WHOIS_Lookup\", parent_action=action)\n\n    return",
                        "callback_code": "def WHOIS_Lookup_callback(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('WHOIS_Lookup_callback() called')\n    \n    Censys_IO_IP_Lookup(action=action, success=success, container=container, results=results, handle=handle)\n    PassiveTotal_IP_Reputation(action=action, success=success, container=container, results=results, handle=handle)\n\n    return",
                        "callback_start": 105,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "Geolocate IP",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "WHOIS Lookup",
                        "delay": 0,
                        "description": "WHOIS lookup on the IP address",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "5c4cb229-8f0b-4ac2-a106-82f25a0872c6",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 113,
                        "line_start": 82,
                        "message": "Configuring now",
                        "name": "whois ip",
                        "notes": "WHOIS lookup on the IP address",
                        "number": 1,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 600,
                            "y": 260
                        },
                        "previous_function": "",
                        "previous_name": "WHOIS_Lookup",
                        "required_params": {
                            "ip": true
                        },
                        "reviewer": "",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "action_assets",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 640
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "916754f2-4a7c-4a72-9ff5-beb11bd6f517",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "ad04a24d-9496-4fb8-810c-f388679c2590",
                            "port": "out-1",
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "97a62ca0-1914-4ef2-b779-56cb692b559a",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 642
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "00affc33-0b6b-49d0-9aa9-23cec8305cdf",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "ad04a24d-9496-4fb8-810c-f388679c2590",
                            "port": "out-1",
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "79f28b84-d3b0-4322-9da2-848949d8048f",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 643
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "api": "add comment",
                        "attrs": {
                            ".api": {
                                "text": "Add Data To Container"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "API"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def Add_Data_To_Container(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('Add_Data_To_Container() called')\n\n    formatted_data_1 = phantom.get_format_data(name='Format_Results')\n\n    phantom.comment(container=container, comment=formatted_data_1)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "color": "",
                        "configured": [
                            {
                                "addCommentComment": "Format_Results:formatted_data",
                                "key": "add-comment"
                            }
                        ],
                        "connected_to_start": true,
                        "connection_name": "Censys IO Certificate Lookup, PassiveTotal IP Reputation, Malware Domain Lookup, Passive Total Domain Reputation",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "Add Data To Container",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "da2f10c6-2cd8-427a-8d17-06c8f9496d2b",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 122,
                        "line_start": 113,
                        "message": "Configuring now",
                        "name": "add comment",
                        "notes": "",
                        "number": 3,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1640,
                            "y": 440
                        },
                        "previous_function": "",
                        "previous_name": "Add_Data_To_Container",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "api",
                        "status": "",
                        "title": "API",
                        "type": "coa.API",
                        "warn": false,
                        "z": 644
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".format": {
                                "text": "Format Results"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out-1": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out-1>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "format"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def Format_Results(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('Format_Results() called')\n    \n    template = \"\"\"IP Address Information\nGeoIP Information {0}\nWhois Information {1}\nIP Classification {5}\nIs IP Sinkholed {6}\nSSL Certificate From IP Details\nIssuer Common Name {2}\nIssuer Country {3}\nIssuer Org {4}\n\nDomain Information\nIs domain a known malware domain list: {7}\nPassive Total Domain Reputation: {8}\"\"\"\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"Geolocate_IP:action_result.message\",\n        \"WHOIS_Lookup:action_result.message\",\n        \"Censys_IO_IP_Lookup:action_result.data.*.ports.443.https.tls.certificate.parsed.issuer.common_name\",\n        \"Censys_IO_IP_Lookup:action_result.data.*.ports.443.https.tls.certificate.parsed.issuer.country\",\n        \"Censys_IO_IP_Lookup:action_result.data.*.ports.443.https.tls.certificate.parsed.issuer.organization\",\n        \"PassiveTotal_IP_Reputation:action_result.summary.classification\",\n        \"PassiveTotal_IP_Reputation:action_result.data.*.sinkhole\",\n        \"Malware_Domain_Lookup:action_result.summary.malicious\",\n        \"Passive_Total_Domain_Reputation:action_result.data.*.classification.classification\",\n    ]\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"Format_Results\")\n\n    Add_Data_To_Container(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "Censys IO Certificate Lookup, PassiveTotal IP Reputation, Malware Domain Lookup, Passive Total Domain Reputation",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "Format Results",
                        "description": "",
                        "format": "format",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "9be467a5-9d8f-4894-ac82-34aa649b8795",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "def join_Format_Results(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('join_Format_Results() called')\n\n    # check if all connected incoming actions are done i.e. have succeeded or failed\n    if phantom.actions_done([ 'Censys_IO_Certificate_Lookup', 'PassiveTotal_IP_Reputation', 'Malware_Domain_Lookup', 'Passive_Total_Domain_Reputation' ]):\n        \n        # call connected block \"Format_Results\"\n        Format_Results(container=container, handle=handle)\n    \n    return",
                        "join_optional": [],
                        "join_start": 158,
                        "line_end": 169,
                        "line_start": 122,
                        "message": "Configuring now",
                        "name": "format",
                        "notes": "",
                        "number": 3,
                        "outPorts": [
                            "out-1"
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "Geolocate_IP:action_result.message"
                            },
                            {
                                "position": 1,
                                "type": "",
                                "value": "WHOIS_Lookup:action_result.message"
                            },
                            {
                                "position": 2,
                                "type": "",
                                "value": "Censys_IO_IP_Lookup:action_result.data.*.ports.443.https.tls.certificate.parsed.issuer.common_name"
                            },
                            {
                                "position": 3,
                                "type": "",
                                "value": "Censys_IO_IP_Lookup:action_result.data.*.ports.443.https.tls.certificate.parsed.issuer.country"
                            },
                            {
                                "position": 4,
                                "type": "",
                                "value": "Censys_IO_IP_Lookup:action_result.data.*.ports.443.https.tls.certificate.parsed.issuer.organization"
                            },
                            {
                                "position": 5,
                                "type": "",
                                "value": "PassiveTotal_IP_Reputation:action_result.summary.classification"
                            },
                            {
                                "position": 6,
                                "type": "",
                                "value": "PassiveTotal_IP_Reputation:action_result.data.*.sinkhole"
                            },
                            {
                                "position": 7,
                                "type": "",
                                "value": "Malware_Domain_Lookup:action_result.summary.malicious"
                            },
                            {
                                "position": 8,
                                "type": "",
                                "value": "Passive_Total_Domain_Reputation:action_result.data.*.classification.classification"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1420,
                            "y": 440
                        },
                        "previous_function": "",
                        "previous_name": "Format_Results",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "format",
                        "status": "",
                        "template": "IP Address Information\nGeoIP Information {0}\nWhois Information {1}\nIP Classification {5}\nIs IP Sinkholed {6}\nSSL Certificate From IP Details\nIssuer Common Name {2}\nIssuer Country {3}\nIssuer Org {4}\n\nDomain Information\nIs domain a known malware domain list: {7}\nPassive Total Domain Reputation: {8}",
                        "title": "format",
                        "type": "coa.Format",
                        "warn": false,
                        "z": 645
                    },
                    {
                        "action": "domain reputation",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "domain": "artifact:*.cef.query",
                            "from": "",
                            "to": ""
                        },
                        "angle": 0,
                        "app": "PassiveTotal",
                        "approver": "",
                        "assets": [
                            {
                                "action": "domain reputation",
                                "active": true,
                                "app_name": "PassiveTotal",
                                "app_version": "1.2.28",
                                "config_type": "app",
                                "fields": {
                                    "domain": "artifact:*.cef.query",
                                    "from": "",
                                    "to": ""
                                },
                                "has_app": true,
                                "id": 154,
                                "loaded": false,
                                "missing": false,
                                "name": "PassiveTotal",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Domain",
                                        "column_order": 0,
                                        "contains": [
                                            "domain"
                                        ],
                                        "data_path": "action_result.parameter.domain",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.from",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.to",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Ever Compromised",
                                        "column_order": 1,
                                        "data_path": "action_result.summary.ever_compromised",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "column_name": "Classification",
                                        "column_order": 2,
                                        "data_path": "action_result.summary.classification",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Total Unique Domains",
                                        "column_order": 3,
                                        "data_path": "action_result.summary.total_unique_domains",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "column_name": "First Seen",
                                        "column_order": 4,
                                        "data_path": "action_result.summary.first_seen",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Last Seen",
                                        "column_order": 5,
                                        "data_path": "action_result.summary.last_seen",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Dynamic Domain",
                                        "column_order": 6,
                                        "data_path": "action_result.summary.dynamic_domain",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "contains": [
                                            "domain"
                                        ],
                                        "data_path": "action_result.data.*.unique",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.value",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.source",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.data.*.passive.results.*.resolve",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.lastSeen",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.collected",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.firstSeen",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.recordHash",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.recordType",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.resolveType",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.lastSeen",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.firstSeen",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.queryType",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.queryValue",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.totalRecords",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.tld",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.tags",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.queryType",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.dynamicDns",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.queryValue",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "domain"
                                        ],
                                        "data_path": "action_result.data.*.metadata.primaryDomain",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.classification",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.everCompromised",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.sinkhole",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.classification.classification",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ever_compromised",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.summary.sinkhole",
                                        "data_type": "boolean"
                                    }
                                ],
                                "parameters": {
                                    "domain": {
                                        "contains": [
                                            "domain"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Domain to query",
                                        "key": "domain",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    },
                                    "from": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Start date for Passive data (YYYY-mm-dd)",
                                        "key": "from",
                                        "order": 2,
                                        "required": false
                                    },
                                    "ph": {
                                        "data_type": "ph",
                                        "default": null,
                                        "key": "ph",
                                        "order": 1,
                                        "required": false
                                    },
                                    "to": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "End date for Passive data (YYYY-mm-dd)",
                                        "key": "to",
                                        "order": 3,
                                        "required": false
                                    }
                                },
                                "product_name": "PassiveTotal",
                                "product_vendor": "PassiveTotal",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "Passive Total Domain Re..."
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def Passive_Total_Domain_Reputation(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('Passive_Total_Domain_Reputation() called')\n\n    # collect data for 'Passive_Total_Domain_Reputation' call\n    container_data = phantom.collect2(container=container, datapath=['artifact:*.cef.query', 'artifact:*.id'])\n\n    parameters = []\n    \n    # build parameters list for 'Passive_Total_Domain_Reputation' call\n    for container_item in container_data:\n        if container_item[0]:\n            parameters.append({\n                'to': \"\",\n                'domain': container_item[0],\n                'from': \"\",\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': container_item[1]},\n            })\n\n    phantom.act(\"domain reputation\", parameters=parameters, app={ \"name\": 'PassiveTotal' }, callback=join_Format_Results, name=\"Passive_Total_Domain_Reputation\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "Passive Total Domain Reputation",
                        "delay": "0",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "79f28b84-d3b0-4322-9da2-848949d8048f",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 216,
                        "line_start": 193,
                        "message": "Configuring now",
                        "name": "domain reputation",
                        "notes": "",
                        "number": 2,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 440,
                            "y": 580
                        },
                        "previous_function": "",
                        "previous_name": "Passive_Total_Domain_Reputation",
                        "required_params": {
                            "domain": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_config",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 648
                    },
                    {
                        "action": "domain reputation",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "domain": "artifact:*.cef.query",
                            "include_inactive": ""
                        },
                        "angle": 0,
                        "app": "Malware Domain List",
                        "approver": "",
                        "assets": [
                            {
                                "action": "domain reputation",
                                "active": true,
                                "app_name": "Malware Domain List",
                                "app_version": "1.0.11",
                                "config_type": "app",
                                "fields": {
                                    "domain": "artifact:*.cef.query",
                                    "include_inactive": ""
                                },
                                "has_app": true,
                                "id": 88,
                                "loaded": false,
                                "missing": false,
                                "name": "Malware Domain List",
                                "output": [
                                    {
                                        "column_name": "Domain",
                                        "column_order": 0,
                                        "contains": [
                                            "domain"
                                        ],
                                        "data_path": "action_result.data.*.Domain",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Path",
                                        "column_order": 1,
                                        "data_path": "action_result.data.*.Path",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Description",
                                        "column_order": 3,
                                        "data_path": "action_result.data.*.Description",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "IP",
                                        "column_order": 2,
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.data.*.IP",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "ASN",
                                        "column_order": 7,
                                        "data_path": "action_result.data.*.ASN",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Reverse Lookup",
                                        "column_order": 4,
                                        "contains": [
                                            "domain"
                                        ],
                                        "data_path": "action_result.data.*.ReverseLookup",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Date (UTC)",
                                        "column_order": 8,
                                        "data_path": "action_result.data.*.DateUTC",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Registrant",
                                        "column_order": 6,
                                        "data_path": "action_result.data.*.Registrant",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Country",
                                        "column_order": 5,
                                        "data_path": "action_result.data.*.Country",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.CountryCode",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "domain",
                                            "url"
                                        ],
                                        "data_path": "action_result.parameter.domain",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.include_inactive",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary.matching_records",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.summary.malicious",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "domain": {
                                        "contains": [
                                            "domain",
                                            "url"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Domain",
                                        "key": "domain",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    },
                                    "include_inactive": {
                                        "data_type": "boolean",
                                        "default": false,
                                        "description": "Include inactive sites",
                                        "key": "include_inactive",
                                        "primary": false,
                                        "required": false
                                    }
                                },
                                "product_name": "Malware Domain List",
                                "product_vendor": "Malware Domain List",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "Malware Domain Lookup"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def Malware_Domain_Lookup(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('Malware_Domain_Lookup() called')\n\n    # collect data for 'Malware_Domain_Lookup' call\n    container_data = phantom.collect2(container=container, datapath=['artifact:*.cef.query', 'artifact:*.id'])\n\n    parameters = []\n    \n    # build parameters list for 'Malware_Domain_Lookup' call\n    for container_item in container_data:\n        if container_item[0]:\n            parameters.append({\n                'domain': container_item[0],\n                'include_inactive': \"\",\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': container_item[1]},\n            })\n\n    phantom.act(\"domain reputation\", parameters=parameters, app={ \"name\": 'Malware Domain List' }, callback=join_Format_Results, name=\"Malware_Domain_Lookup\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "Malware Domain Lookup",
                        "delay": 0,
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "97a62ca0-1914-4ef2-b779-56cb692b559a",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 238,
                        "line_start": 216,
                        "message": "Configuring now",
                        "name": "domain reputation",
                        "notes": "",
                        "number": 1,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 440,
                            "y": 440
                        },
                        "previous_function": "",
                        "previous_name": "Malware_Domain_Lookup",
                        "required_params": {
                            "domain": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_config",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 649
                    },
                    {
                        "action": "ip reputation",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "from": "",
                            "ip": "artifact:*.cef.current_answer",
                            "to": ""
                        },
                        "angle": 0,
                        "app": "PassiveTotal",
                        "approver": "",
                        "assets": [
                            {
                                "action": "ip reputation",
                                "active": true,
                                "app_name": "PassiveTotal",
                                "app_version": "1.2.28",
                                "config_type": "app",
                                "fields": {
                                    "from": "",
                                    "ip": "artifact:*.cef.current_answer",
                                    "to": ""
                                },
                                "has_app": true,
                                "id": 154,
                                "loaded": false,
                                "missing": false,
                                "name": "PassiveTotal",
                                "output": [
                                    {
                                        "data_path": "action_result.data.*.metadata.tld",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.tags",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.country",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.network",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.latitude",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.sinkhole",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.longitude",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.queryType",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.queryValue",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "domain"
                                        ],
                                        "data_path": "action_result.data.*.metadata.primaryDomain",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.classification",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.everCompromised",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.autonomousSystemName",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.autonomousSystemNumber",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.sinkhole",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.classification.classification",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ever_compromised",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary.as_name",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Country",
                                        "column_order": 3,
                                        "data_path": "action_result.summary.country",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Sinkholed",
                                        "column_order": 2,
                                        "data_path": "action_result.summary.sinkhole",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.summary.classification",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Ever Compromised",
                                        "column_order": 1,
                                        "data_path": "action_result.summary.ever_compromised",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.parameter.from",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.to",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "IP",
                                        "column_order": 0,
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.parameter.ip",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "contains": [
                                            "domain"
                                        ],
                                        "data_path": "action_result.data.*.unique",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.value",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.source",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.resolve",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.lastSeen",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.collected",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.firstSeen",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.recordHash",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.lastSeen",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.firstSeen",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.queryType",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.queryValue",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.totalRecords",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ssl_certificates.*.sha1",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ssl_certificates.*.lastSeen",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ssl_certificates.*.firstSeen",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ssl_certificates.*.ipAddresses",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary.last_seen",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary.first_seen",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary.total_unique_domains",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "from": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Start date for Passive data (YYYY-mm-dd)",
                                        "key": "from",
                                        "order": 2,
                                        "required": false
                                    },
                                    "ip": {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "IP to query",
                                        "key": "ip",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    },
                                    "ph": {
                                        "data_type": "ph",
                                        "default": null,
                                        "key": "ph",
                                        "order": 1,
                                        "required": false
                                    },
                                    "to": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "End date for Passive data (YYYY-mm-dd)",
                                        "key": "to",
                                        "order": 3,
                                        "required": false
                                    }
                                },
                                "product_name": "PassiveTotal",
                                "product_vendor": "PassiveTotal",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "PassiveTotal IP Reputati..."
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def PassiveTotal_IP_Reputation(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('PassiveTotal_IP_Reputation() called')\n    \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'PassiveTotal_IP_Reputation' call\n    container_data = phantom.collect2(container=container, datapath=['artifact:*.cef.current_answer', 'artifact:*.id'])\n\n    parameters = []\n    \n    # build parameters list for 'PassiveTotal_IP_Reputation' call\n    for container_item in container_data:\n        if container_item[0]:\n            parameters.append({\n                'ip': container_item[0],\n                'from': \"\",\n                'to': \"\",\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': container_item[1]},\n            })\n\n    phantom.act(\"ip reputation\", parameters=parameters, app={ \"name\": 'PassiveTotal' }, callback=join_Format_Results, name=\"PassiveTotal_IP_Reputation\", parent_action=action)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "WHOIS Lookup",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "PassiveTotal IP Reputation",
                        "delay": 0,
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "672d282b-7a34-40da-aab8-d72b9e14fa29",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 309,
                        "line_start": 284,
                        "message": "Configuring now",
                        "name": "ip reputation",
                        "notes": "",
                        "number": 2,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 860,
                            "y": 400
                        },
                        "previous_function": "",
                        "previous_name": "PassiveTotal_IP_Reputation",
                        "required_params": {
                            "ip": true
                        },
                        "reviewer": "",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_config",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 656
                    },
                    {
                        "action": "geolocate ip",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "ip": "artifact:*.cef.current_answer"
                        },
                        "angle": 0,
                        "app": "",
                        "approver": "",
                        "assets": [
                            {
                                "action": "",
                                "active": true,
                                "app_name": "",
                                "app_version": "",
                                "config_type": "asset",
                                "fields": {
                                    "ip": "artifact:*.cef.current_answer"
                                },
                                "has_app": true,
                                "id": "-",
                                "loaded": false,
                                "missing": false,
                                "name": "maxmind",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.continent_name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.country_iso_code",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.country_name",
                                        "data_type": "string",
                                        "map_info": "Country"
                                    },
                                    {
                                        "data_path": "action_result.data.*.latitude",
                                        "data_type": "numeric",
                                        "map_info": "latitude"
                                    },
                                    {
                                        "data_path": "action_result.data.*.longitude",
                                        "data_type": "numeric",
                                        "map_info": "longitude"
                                    },
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.parameter.ip",
                                        "data_type": "string",
                                        "map_info": "IP Address"
                                    },
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.parameter.ip",
                                        "data_type": "string",
                                        "map_info": "name"
                                    },
                                    {
                                        "data_path": "action_result.data.*.city_name",
                                        "data_type": "string",
                                        "map_info": "City"
                                    },
                                    {
                                        "data_path": "action_result.data.*.postal_code",
                                        "data_type": "string",
                                        "map_info": "Postal Code"
                                    },
                                    {
                                        "data_path": "action_result.data.*.as_org",
                                        "data_type": "string",
                                        "map_info": "Organization"
                                    },
                                    {
                                        "data_path": "action_result.data.*.state_iso_code",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.state_name",
                                        "data_type": "string",
                                        "map_info": "State/Province"
                                    },
                                    {
                                        "data_path": "action_result.data.*.time_zone",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "product_name": "",
                                "product_vendor": "",
                                "type": "information"
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "Geolocate IP"
                            },
                            ".border": {
                                "height": 88
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "fill": "#FFFFFF",
                                "font-size": 12,
                                "font-weight": 300,
                                "opacity": 0,
                                "ref": ".background",
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block",
                                "opacity": 1
                            },
                            "g.notes image": {
                                "xlink:href": "/inc/coa/img/block_icon_note_on.svg"
                            },
                            "rect.warn-background": {
                                "fill": "#FFFFFF"
                            },
                            "text.icon": {
                                "fill": "#FFFFFF"
                            }
                        },
                        "block_code": "def Geolocate_IP(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('Geolocate_IP() called')\n\n    # collect data for 'Geolocate_IP' call\n    container_data = phantom.collect2(container=container, datapath=['artifact:*.cef.current_answer', 'artifact:*.id'])\n\n    parameters = []\n    \n    # build parameters list for 'Geolocate_IP' call\n    for container_item in container_data:\n        if container_item[0]:\n            parameters.append({\n                'ip': container_item[0],\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': container_item[1]},\n            })\n\n    phantom.act(\"geolocate ip\", parameters=parameters, assets=['maxmind'], callback=WHOIS_Lookup, name=\"Geolocate_IP\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "#654796",
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "Geolocate IP",
                        "delay": 0,
                        "description": "Geolocate the IP address using Maxmind",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "7611cb89-72b4-48c2-b47f-3c36f3782911",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 193,
                        "line_start": 172,
                        "message": "Configuring now",
                        "name": "geolocate ip",
                        "notes": "Geolocate the IP address in cef.dst Maxmind",
                        "number": 2,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 360,
                            "y": 260
                        },
                        "previous_function": "",
                        "previous_name": "Geolocate_IP",
                        "required_params": {
                            "ip": true
                        },
                        "reviewer": "",
                        "show_number": false,
                        "size": {
                            "height": 112,
                            "width": 168
                        },
                        "state": "action_assets",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 659
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "transform": "rotate(45 30 70)"
                            },
                            ".border": {
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 1
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "block"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.notes": {
                                "display": "block",
                                "opacity": 1
                            },
                            "g.notes image": {
                                "xlink:href": "/inc/coa/img/block_icon_note_on.svg"
                            }
                        },
                        "block_code": "def filter_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('filter_1() called')\n\n    # collect filtered artifact ids for 'if' condition 1\n    matched_artifacts_1, matched_results_1 = phantom.condition(\n        container=container,\n        conditions=[\n            [\"artifact:*.cef.current_answer\", \"!=\", \"\"],\n        ],\n        name=\"filter_1:condition_1\")\n\n    # call connected blocks if filtered artifacts or results\n    if matched_artifacts_1 or matched_results_1:\n        Geolocate_IP(action=action, success=success, container=container, results=results, handle=handle, filtered_artifacts=matched_artifacts_1, filtered_results=matched_results_1)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "Condition 1:  Investigate artifacts where sourceAddress is not empty\nCondition 2: Investigate artifacts where destinationAddress is not empty\nCondition 3: Investigate artifacts where dst is not empty\nCondition 4: Investigate artifacts where src is not empty",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "579d254e-f7e0-4713-9ff1-ffe6e95159e3",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 56,
                        "line_start": 39,
                        "name": "filter",
                        "notes": "Filter the fields that commonly contain IP addresses to feed those artifacts into investigation actions.",
                        "number": 1,
                        "outPorts": [
                            "out-1"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": "!=",
                                        "data_type": "",
                                        "param": "artifact:*.cef.current_answer",
                                        "value": ""
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 220,
                            "y": 260
                        },
                        "previous_function": "",
                        "previous_name": "filter_1",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "filter",
                        "status": "",
                        "type": "coa.Filter",
                        "warn": false,
                        "z": 660
                    },
                    {
                        "action": "lookup ip",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "ip": "artifact:*.cef.current_answer"
                        },
                        "angle": 0,
                        "app": "Censys",
                        "approver": "",
                        "assets": [
                            {
                                "action": "lookup ip",
                                "active": true,
                                "app_name": "Censys",
                                "app_version": "1.0.19",
                                "asset_name": "censys",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "ip": "artifact:*.cef.current_answer"
                                },
                                "has_app": true,
                                "id": 57,
                                "loaded": false,
                                "missing": false,
                                "name": "censys",
                                "output": [
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.data.*.ip",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.tags",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.body",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.headers.vary",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.headers.pragma",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.headers.server",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.headers.expires",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.headers.unknown.*.key",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.headers.unknown.*.value",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.headers.connection",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.headers.content_type",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.headers.cache_control",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.headers.x_frame_options",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.headers.x_ua_compatible",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.headers.content_language",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.headers.strict_transport_security",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.body_sha256",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.status_code",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.status_line",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.dhe.support",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.issuer.country",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.issuer.common_name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.issuer.organization",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.issuer.organizational_unit",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.subject.country",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.subject.common_name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.subject.organization",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.subject.organizational_unit",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.version",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.validity.end",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.validity.start",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.validity.length",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.issuer_dn",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.signature.valid",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.signature.value",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.signature.self_signed",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.signature.signature_algorithm.oid",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.signature.signature_algorithm.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.extensions.key_usage.value",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.extensions.key_usage.crl_sign",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.extensions.key_usage.certificate_sign",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.extensions.subject_key_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.extensions.authority_key_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.extensions.subject_alt_name.directory_names.*.common_name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.extensions.basic_constraints.is_ca",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.extensions.basic_constraints.max_path_len",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.extensions.certificate_policies",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.extensions.authority_info_access.ocsp_urls",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.extensions.crl_distribution_points",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.subject_dn",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.serial_number",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "md5"
                                        ],
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.fingerprint_md5",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.tbs_fingerprint",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.fingerprint_sha1",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.subject_key_info.key_algorithm.oid",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.subject_key_info.key_algorithm.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.subject_key_info.rsa_public_key.length",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.subject_key_info.rsa_public_key.modulus",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.subject_key_info.rsa_public_key.exponent",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "contains": [
                                            "sha256"
                                        ],
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.subject_key_info.fingerprint_sha256",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.validation_level",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "sha256"
                                        ],
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.fingerprint_sha256",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.signature_algorithm.oid",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.signature_algorithm.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.tbs_noct_fingerprint",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.spki_subject_fingerprint",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.version",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.signature.valid",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.signature.hash_algorithm",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.signature.signature_algorithm",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.validation.browser_trusted",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.names",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.issuer.country",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.issuer.common_name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.issuer.organization",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.issuer.organizational_unit",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.subject.country",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.subject.locality",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.subject.province",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.subject.common_name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.subject.organization",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.version",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.validity.end",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.validity.start",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.validity.length",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.issuer_dn",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.signature.valid",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.signature.value",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.signature.self_signed",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.signature.signature_algorithm.oid",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.signature.signature_algorithm.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.extensions.key_usage.value",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.extensions.key_usage.key_encipherment",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.extensions.key_usage.digital_signature",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.extensions.authority_key_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.extensions.subject_alt_name.dns_names",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.extensions.basic_constraints.is_ca",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.extensions.extended_key_usage",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.extensions.certificate_policies",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.extensions.authority_info_access.ocsp_urls",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.extensions.authority_info_access.issuer_urls",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.extensions.crl_distribution_points",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.subject_dn",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.serial_number",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.fingerprint_md5",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.tbs_fingerprint",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.fingerprint_sha1",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.subject_key_info.key_algorithm.oid",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.subject_key_info.key_algorithm.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.subject_key_info.rsa_public_key.length",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.subject_key_info.rsa_public_key.modulus",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.subject_key_info.rsa_public_key.exponent",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "contains": [
                                            "sha256"
                                        ],
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.subject_key_info.fingerprint_sha256",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.validation_level",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "sha256"
                                        ],
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.fingerprint_sha256",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.signature_algorithm.oid",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.signature_algorithm.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.tbs_noct_fingerprint",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.spki_subject_fingerprint",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.cipher_suite.id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.cipher_suite.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.ocsp_stapling",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.server_key_exchange.ecdh_params.curve_id.id",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.server_key_exchange.ecdh_params.curve_id.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.ssl_2.export",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.ssl_2.support",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.ssl_2.extra_clear",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.dhe_export.support",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.heartbleed.heartbeat_enabled",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.heartbleed.heartbleed_vulnerable",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.rsa_export.support",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.location.city",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.location.country",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.location.latitude",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.location.province",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.location.timezone",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.location.continent",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.location.longitude",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.location.postal_code",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.location.country_code",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.location.registered_country",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.location.registered_country_code",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.protocols",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.updated_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.autonomous_system.asn",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.autonomous_system.rir",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.autonomous_system.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.autonomous_system.path",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.autonomous_system.description",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.autonomous_system.country_code",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.autonomous_system.organization",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.autonomous_system.routed_prefix",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary.protocols",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.parameter.ip",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "ip": {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "IP to get info of",
                                        "key": "ip",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    }
                                },
                                "product_name": "Censys",
                                "product_vendor": "Censys",
                                "targets": "25",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "Censys IO IP Lookup"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def Censys_IO_IP_Lookup(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('Censys_IO_IP_Lookup() called')\n    \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'Censys_IO_IP_Lookup' call\n    container_data = phantom.collect2(container=container, datapath=['artifact:*.cef.current_answer', 'artifact:*.id'])\n\n    parameters = []\n    \n    # build parameters list for 'Censys_IO_IP_Lookup' call\n    for container_item in container_data:\n        if container_item[0]:\n            parameters.append({\n                'ip': container_item[0],\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': container_item[1]},\n            })\n\n    phantom.act(\"lookup ip\", parameters=parameters, assets=['censys'], callback=Check_if_data_found_for_Censys_query, name=\"Censys_IO_IP_Lookup\", parent_action=action)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "WHOIS Lookup",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "Censys IO IP Lookup",
                        "delay": 0,
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "3640d401-19b9-4d63-b389-f76477198916",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 261,
                        "line_start": 238,
                        "message": "Configuring now",
                        "name": "lookup ip",
                        "notes": "",
                        "number": 1,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 860,
                            "y": 260
                        },
                        "previous_function": "",
                        "previous_name": "Censys_IO_IP_Lookup",
                        "required_params": {
                            "ip": true
                        },
                        "reviewer": "",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 663
                    },
                    {
                        "action": "lookup certificate",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "sha256": "Censys_IO_IP_Lookup:action_result.data.*.ports.443.https.tls.certificate.parsed.fingerprint_sha256"
                        },
                        "angle": 0,
                        "app": "Censys",
                        "approver": "",
                        "assets": [
                            {
                                "action": "lookup certificate",
                                "active": true,
                                "app_name": "Censys",
                                "app_version": "1.0.19",
                                "config_type": "app",
                                "fields": {
                                    "sha256": "Censys_IO_IP_Lookup:action_result.data.*.ports.443.https.tls.certificate.parsed.fingerprint_sha256"
                                },
                                "has_app": true,
                                "id": 57,
                                "loaded": false,
                                "missing": false,
                                "name": "Censys",
                                "output": [
                                    {
                                        "data_path": "action_result.data.*.ct.digicert_ct1.index",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.digicert_ct1.added_to_ct_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.digicert_ct1.ct_to_censys_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_pilot.sct",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_pilot.index",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_pilot.added_to_ct_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_pilot.censys_to_ct_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_pilot.ct_to_censys_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_pilot.censys_to_ct_status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.wosign_ctlog.index",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.wosign_ctlog.added_to_ct_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.wosign_ctlog.ct_to_censys_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_aviator.sct",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_aviator.index",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_aviator.added_to_ct_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_aviator.censys_to_ct_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_aviator.ct_to_censys_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_aviator.censys_to_ct_status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.symantec_ws_ct.index",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.symantec_ws_ct.added_to_ct_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.symantec_ws_ct.ct_to_censys_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_rocketeer.sct",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_rocketeer.index",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_rocketeer.added_to_ct_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_rocketeer.censys_to_ct_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_rocketeer.ct_to_censys_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_rocketeer.censys_to_ct_status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.symantec_ws_vega.index",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.symantec_ws_vega.added_to_ct_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.symantec_ws_vega.ct_to_censys_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.venafi_api_ctlog.index",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.venafi_api_ctlog.added_to_ct_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.venafi_api_ctlog.ct_to_censys_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_submariner.index",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_submariner.added_to_ct_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_submariner.ct_to_censys_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.symantec_ws_deneb.index",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.symantec_ws_deneb.added_to_ct_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.symantec_ws_deneb.ct_to_censys_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.raw",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.audit.nss.is_in",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.audit.nss.was_in",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.in_nss",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.issuer.country",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.issuer.common_name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.issuer.organization",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.issuer.organizational_unit",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.subject.country",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.subject.common_name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.subject.organization",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.subject.organizational_unit",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.version",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.validity.end",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.validity.start",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.validity.length",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.issuer_dn",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.signature.valid",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.signature.value",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.signature.self_signed",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.signature.signature_algorithm.oid",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.signature.signature_algorithm.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.extensions.key_usage.value",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.extensions.key_usage.crl_sign",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.extensions.key_usage.certificate_sign",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.extensions.subject_key_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.extensions.authority_key_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.extensions.subject_alt_name.directory_names.*.common_name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.extensions.basic_constraints.is_ca",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.extensions.basic_constraints.max_path_len",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.extensions.certificate_policies",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.extensions.authority_info_access.ocsp_urls",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.extensions.crl_distribution_points",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.subject_dn",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.serial_number",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.fingerprint_md5",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.tbs_fingerprint",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.fingerprint_sha1",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.subject_key_info.key_algorithm.oid",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.subject_key_info.key_algorithm.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.subject_key_info.rsa_public_key.length",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.subject_key_info.rsa_public_key.modulus",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.subject_key_info.rsa_public_key.exponent",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "contains": [
                                            "sha256"
                                        ],
                                        "data_path": "action_result.data.*.parsed.subject_key_info.fingerprint_sha256",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.validation_level",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "sha256"
                                        ],
                                        "data_path": "action_result.data.*.parsed.fingerprint_sha256",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.signature_algorithm.oid",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.signature_algorithm.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.tbs_noct_fingerprint",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.spki_subject_fingerprint",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.source",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parents",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.precert",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.valid_nss",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.updated_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.was_in_nss",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.seen_in_scan",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.was_valid_nss",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.current_in_nss",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.post_processed",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.current_valid_nss",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.validation_timestamp",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary.valid_to",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary.issuer_dn",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary.subject_dn",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary.valid_from",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "hash",
                                            "sha256"
                                        ],
                                        "data_path": "action_result.parameter.sha256",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "sha256": {
                                        "contains": [
                                            "hash",
                                            "sha256"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "SHA256 fingerprint of certificate",
                                        "key": "sha256",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    }
                                },
                                "product_name": "Censys",
                                "product_vendor": "Censys",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "Censys IO Certificate Loo..."
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def Censys_IO_Certificate_Lookup(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('Censys_IO_Certificate_Lookup() called')\n    \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'Censys_IO_Certificate_Lookup' call\n    results_data_1 = phantom.collect2(container=container, datapath=['Censys_IO_IP_Lookup:action_result.data.*.ports.443.https.tls.certificate.parsed.fingerprint_sha256', 'Censys_IO_IP_Lookup:action_result.parameter.context.artifact_id'], action_results=results)\n\n    parameters = []\n    \n    # build parameters list for 'Censys_IO_Certificate_Lookup' call\n    for results_item_1 in results_data_1:\n        if results_item_1[0]:\n            parameters.append({\n                'sha256': results_item_1[0],\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': results_item_1[1]},\n            })\n\n    phantom.act(\"lookup certificate\", parameters=parameters, app={ \"name\": 'Censys' }, callback=join_Format_Results, name=\"Censys_IO_Certificate_Lookup\", parent_action=action)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "Censys IO IP Lookup",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "Censys IO Certificate Lookup",
                        "delay": 0,
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "a133dd12-e4c4-4daf-8cf2-072f80ba7724",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 284,
                        "line_start": 261,
                        "message": "Configuring now",
                        "name": "lookup certificate",
                        "notes": "",
                        "number": 1,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1260,
                            "y": 260
                        },
                        "previous_function": "",
                        "previous_name": "Censys_IO_Certificate_Lookup",
                        "required_params": {
                            "sha256": true
                        },
                        "reviewer": "",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_config",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": "",
                        "z": 664
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "9335c7af-180e-4186-b41b-299ffe2be7f0",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "3640d401-19b9-4d63-b389-f76477198916",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "c27bc95c-46f0-4d79-88da-5fbe93fea0e1",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 665
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "82d10626-38fa-4ed2-aaa9-cfa9a3a800d9",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "c27bc95c-46f0-4d79-88da-5fbe93fea0e1",
                            "port": "out-1",
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "a133dd12-e4c4-4daf-8cf2-072f80ba7724",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 668
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 3
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def Check_if_data_found_for_Censys_query(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('Check_if_data_found_for_Censys_query() called')\n\n    # collect filtered artifact ids for 'if' condition 1\n    matched_artifacts_1, matched_results_1 = phantom.condition(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"Censys_IO_IP_Lookup:action_result.data.*.ports.443.https.tls.certificate.parsed.fingerprint_sha256\", \"!=\", \"\"],\n        ],\n        name=\"Check_if_data_found_for_Censys_query:condition_1\")\n\n    # call connected blocks if filtered artifacts or results\n    if matched_artifacts_1 or matched_results_1:\n        Censys_IO_Certificate_Lookup(action=action, success=success, container=container, results=results, handle=handle, filtered_artifacts=matched_artifacts_1, filtered_results=matched_results_1)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "Censys IO IP Lookup",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "Check if data found for Censys query",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "c27bc95c-46f0-4d79-88da-5fbe93fea0e1",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 327,
                        "line_start": 309,
                        "name": "filter",
                        "notes": "",
                        "number": 3,
                        "outPorts": [
                            "out-1"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": "!=",
                                        "data_type": "",
                                        "param": "Censys_IO_IP_Lookup:action_result.data.*.ports.443.https.tls.certificate.parsed.fingerprint_sha256",
                                        "value": ""
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1100,
                            "y": 260
                        },
                        "previous_function": "",
                        "previous_name": "Check_if_data_found_for_Censys_query",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "filter",
                        "status": "",
                        "type": "coa.Filter",
                        "warn": "",
                        "z": 669
                    }
                ]
            },
            "notes": "This playbook uses the following Apps:\n - MaxMind (geolocate ip) [asset name = maxmind] - geolocates IP addresses and displays them on a map\n - WHOIS (whois ip) [asset name = whois] - queries the WHOIS database for basic registration information about an IP address\n - DNS (lookup domain) [asset name = dns] - resolves domain names to IP addresses\n - Censys (lookup ip) [asset name = censys] - lookup IPs and pass it to certificate lookups. To check Issuers\n - PassiveTotal (ip and domain reputation) [asset name = passivetotal] - reputation of the pointing IP and Domain"
        },
        "schema": 3,
        "version": "3.5.200"
    },
    "create_time": "2019-02-27T17:11:18.423168+00:00",
    "draft_mode": false,
    "labels": [
        "*"
    ]
}
